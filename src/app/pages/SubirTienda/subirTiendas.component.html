<app-adminnavbar></app-adminnavbar>

<div class="formulario text-center">
  <div class="container">
    <h2 class="m-4">Registro de una tienda nueva</h2>
    <div class="row mb-4">
      <form (ngSubmit)="onSubmitTipo()" [formGroup]="contactForm">
        <div class="col">

          <div class="m-4">
            <label class="form-label display-text" for="formularioTiendaNombre">Nombre</label><br>
            <input [ngModel]="nombreInput" (ngModelChange)="nombreInput = $event.toUpperCase()"
              formControlName="formularioTiendaNombre" name="formularioTiendaNombre"
              [class.is-invalid]="contactForm.get('formularioTiendaNombre').invalid && contactForm.get('formularioTiendaNombre').touched"
              type="text" id="formularioTiendaNombre" class="formulario-input bg-light form-control "
              formControlName="formularioTiendaNombre" required />
            <div
              *ngIf="contactForm.get('formularioTiendaNombre')?.touched && contactForm.get('formularioTiendaNombre')?.errors?.['required'] "
              class="alert alert-danger formulario-error text-center mt-3">*El campo de nombre es obligatorio</div>
            <div
              *ngIf="contactForm.get('formularioTiendaNombre')?.touched && contactForm.get('formularioTiendaNombre')?.errors?.['minlength'] "
              class="alert alert-danger formulario-error mt-3">*El campo de nombre debe contener al menos
              {{contactForm.get('formularioTiendaNombre')?.errors?.['minlength'].requiredLength}} letras</div>
          </div>

          <div class="m-4">
            <label class="form-label display-text" for="formularioTiendaLogo">Logo</label><br>
            <input formControlName="formularioTiendaLogo" name="formularioTiendaLogo"
              [class.is-invalid]="contactForm.get('formularioTiendaLogo').invalid && contactForm.get('formularioTiendaLogo').touched"
              type="text" id="formularioTiendaLogo" class="formulario-input bg-light form-control "
              formControlName="formularioTiendaLogo" required />
            <div
              *ngIf="contactForm.get('formularioTiendaLogo')?.touched && contactForm.get('formularioTiendaLogo')?.errors?.['required'] "
              class="alert alert-danger formulario-error text-center mt-3">*El campo de logo es obligatorio</div>
            <div
              *ngIf="contactForm.get('formularioTiendaLogo')?.touched && contactForm.get('formularioTiendaLogo')?.errors?.['minlength'] "
              class="alert alert-danger formulario-error mt-3">*El campo de logo debe contener al menos
              {{contactForm.get('formularioTiendaLogo')?.errors?.['minlength'].requiredLength}} letras</div>
          </div>

          <div class="m-4">
            <label class="form-label display-text" for="formularioTiendaMapa">Mapa</label><br>
            <input formControlName="formularioTiendaMapa" name="formularioTiendaMapa"
              [class.is-invalid]="contactForm.get('formularioTiendaMapa').invalid && contactForm.get('formularioTiendaMapa').touched"
              type="text" id="formularioTiendaMapa" class="formulario-input bg-light form-control "
              formControlName="formularioTiendaMapa" required />
            <div
              *ngIf="contactForm.get('formularioTiendaMapa')?.touched && contactForm.get('formularioTiendaMapa')?.errors?.['required'] "
              class="alert alert-danger formulario-error text-center mt-3">*El campo de mapa es obligatorio</div>
            <div
              *ngIf="contactForm.get('formularioTiendaMapa')?.touched && contactForm.get('formularioTiendaMapa')?.errors?.['minlength'] "
              class="alert alert-danger formulario-error mt-3">*El campo de mapa debe contener al menos
              {{contactForm.get('formularioTiendaMapa')?.errors?.['minlength'].requiredLength}} letras</div>
          </div>

          <div class="m-4">
            <label class="form-label display-text" for="formularioTiendaDireccion">Direccion</label><br>
            <input formControlName="formularioTiendaDireccion" name="formularioTiendaDireccion"
              [class.is-invalid]="contactForm.get('formularioTiendaDireccion').invalid && contactForm.get('formularioTiendaDireccion').touched"
              type="text" id="formularioTiendaDireccion" class="formulario-input bg-light form-control "
              formControlName="formularioTiendaDireccion" required />
            <div
              *ngIf="contactForm.get('formularioTiendaDireccion')?.touched && contactForm.get('formularioTiendaDireccion')?.errors?.['required'] "
              class="alert alert-danger formulario-error text-center mt-3">*El campo de direccion es obligatorio</div>
            <div
              *ngIf="contactForm.get('formularioTiendaDireccion')?.touched && contactForm.get('formularioTiendaDireccion')?.errors?.['minlength'] "
              class="alert alert-danger formulario-error mt-3">*El campo de direccion debe contener al menos
              {{contactForm.get('formularioTiendaDireccion')?.errors?.['minlength'].requiredLength}} letras</div>
          </div>

          <div class="m-4">
            <label class="form-label display-text" for="formularioTiendaProvincia">Provincia o ciudad</label><br>
            <input formControlName="formularioTiendaProvincia" name="formularioTiendaProvincia"
              [class.is-invalid]="contactForm.get('formularioTiendaProvincia').invalid && contactForm.get('formularioTiendaProvincia').touched"
              type="text" id="formularioTiendaProvincia" class="formulario-input bg-light form-control "
              formControlName="formularioTiendaProvincia" required />
            <div
              *ngIf="contactForm.get('formularioTiendaProvincia')?.touched && contactForm.get('formularioTiendaProvincia')?.errors?.['required'] "
              class="alert alert-danger formulario-error text-center mt-3">*El campo de Provincia es obligatorio</div>
            <div
              *ngIf="contactForm.get('formularioTiendaProvincia')?.touched && contactForm.get('formularioTiendaProvincia')?.errors?.['minlength'] "
              class="alert alert-danger formulario-error mt-3">*El campo de Provincia debe contener al menos
              {{contactForm.get('formularioTiendaProvincia')?.errors?.['minlength'].requiredLength}} letras</div>
          </div>

          <div class="m-4">
            <label class="form-label display-text" for="formularioTiendaPais">País</label><br>
            <input formControlName="formularioTiendaPais" name="formularioTiendaPais"
              [class.is-invalid]="contactForm.get('formularioTiendaPais').invalid && contactForm.get('formularioTiendaPais').touched"
              type="text" id="formularioTiendaPais" class="formulario-input bg-light form-control "
              formControlName="formularioTiendaPais" required />
            <div
              *ngIf="contactForm.get('formularioTiendaPais')?.touched && contactForm.get('formularioTiendaPais')?.errors?.['required'] "
              class="alert alert-danger formulario-error text-center mt-3">*El campo de Pais es obligatorio</div>
            <div
              *ngIf="contactForm.get('formularioTiendaPais')?.touched && contactForm.get('formularioTiendaPais')?.errors?.['minlength'] "
              class="alert alert-danger formulario-error mt-3">*El campo de Pais debe contener al menos
              {{contactForm.get('formularioTiendaPais')?.errors?.['minlength'].requiredLength}} letras</div>
          </div>

          <div class="m-4">
            <label class="form-label display-text" for="formularioTiendaUrl">Url (web o red social)</label><br>
            <input formControlName="formularioTiendaUrl" name="formularioTiendaUrl"
              [class.is-invalid]="contactForm.get('formularioTiendaUrl').invalid && contactForm.get('formularioTiendaUrl').touched"
              type="text" id="formularioTiendaUrl" class="formulario-input bg-light form-control "
              formControlName="formularioTiendaUrl" required />
            <div
              *ngIf="contactForm.get('formularioTiendaUrl')?.touched && contactForm.get('formularioTiendaUrl')?.errors?.['required'] "
              class="alert alert-danger formulario-error text-center mt-3">*El campo de url es obligatorio</div>
            <div
              *ngIf="contactForm.get('formularioTiendaUrl')?.touched && contactForm.get('formularioTiendaUrl')?.errors?.['minlength'] "
              class="alert alert-danger formulario-error mt-3">*El campo de url debe contener al menos
              {{contactForm.get('formularioTiendaUrl')?.errors?.['minlength'].requiredLength}} letras</div>
          </div>


          <button (click)="onSubmitTipo()" [swal]="['Hecho!', 'Has registrado una nueva tienda', 'success']"
            [disabled]="contactForm.invalid" type="submit" id="enviarFormulario"
            class="btn btn-warning btn-block btn-lg mb-4 mt-4">Registrar Tienda
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="container">
  <h1 class="text-center display-text pt-5">Lista de Tiendas a la base</h1>
</div>

<div class="container table-responsive">
  <h2 class="text-center display-text mt-4 mb-4">Buscador de Tiendas</h2>

  <table class="table table-striped mb-4 text-center">
    <thead class="table">
      <tr>
        <th class="display-text">Botones</th>
        <th class="display-text">Nombre</th>
        <th class="display-text">Logo</th>
        <th class="display-text">Mapa</th>
        <th class="display-text">Direccion</th>
        <th class="display-text">URL</th>
      </tr>
    </thead>
    <tbody *ngFor="let store of tiendas | paginate: { itemsPerPage: 10, currentPage: p } ">
      <tr>
        <td>
          <button type="button" class="btn btn-outline-warning m-2"
            [swal]="{ title: '¿Estás seguro que quieres editar la tienda?', showDenyButton: true, denyButtonText: 'Cancelar', icon: 'question'}"
            (confirm)="actualizarTienda(store.idTienda)" (deny)="limpiarFormulario()" (dismiss)="obtenerTiendas()">
            Editar
          </button>

          <button type="button" class="btn btn-outline-danger m-2"
            [swal]="{ title: '¿Estás seguro que quieres eliminar esta tienda?', showDenyButton: true, denyButtonText: 'Cancelar', icon: 'question'}"
            (confirm)="eliminarTienda(store.idTienda)" (deny)="limpiarFormulario()" (dismiss)="obtenerTiendas()">
            Eliminar</button>
        </td>
        <td class="display-text">{{store.nombreTienda}}</td>
        <td class="display-text">{{store.logoTienda}}</td>
        <td class="display-text">{{store.mapaTienda}}</td>
        <td class="display-text">{{store.direccionTienda}}</td>
        <td class="display-text">{{store.urlTienda}}</td>


      </tr>
    </tbody>
  </table>
  <pagination-controls previousLabel="Anterior" nextLabel="Siguiente" class="m-5 my-pagination"
    (pageChange)="p = $event"></pagination-controls>
</div>
